<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- Favicon-->
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
  <!-- Font Awesome icons (free version)-->
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="css/styles.css" rel="stylesheet" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

</head>

<body>

  <!-- Navigation-->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav" style="background-color:#212529;">
    <div class="container">
      <a class="navbar-brand" href="/"><img src="assets/img/navbar-logo.svg" alt="..." /></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
        aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars ms-1"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
          <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
          <!-- <li class="nav-item"><a class="nav-link" href="#portfolio">Portfolio</a></li>
          <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
          <li class="nav-item"><a class="nav-link" href="#team">Team</a></li>
          <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
          <li class="nav-item"><a class="nav-link" href="login2.html">Login</a></li> -->
          <!-- Masthead <li class="nav-item"><a class="nav-link" href="https://172.21.20.115/subjectrightrequest/datasubjectrequestform?key=FGhGHEEv6o6UXUBA68UWtA%3d%3d">DSR</a></li>-->

        </ul>
      </div>
    </div>
  </nav>
  <!-- Masthead-->
  <!-- Services-->
  <section class="page-section" id="services" style="padding-top: 200px;">
    <div class="intro-section" id="home-section">
      <div class="slide-1" style="background-image: url('images/hero.jpg')" data-stellar-background-ratio="0.5">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-12">
              <div class="row align-items-center">
                <div class="col-lg-6 mb-4"> <!-- class="col-lg-6 mb-4" -->
                  <h1 data-aos="fade-up" data-aos-delay="100">Request Preference Consent</h1>
                  <p class="mb-4" data-aos="fade-up" data-aos-delay="200">Provide consent management of business is
                    simple
                    Manage, record consent requests And easily create consent forms for your customers or users to
                    comply with the PDPA.</p>
                  <!-- <p data-aos="fade-up" data-aos-delay="300"><a href="#" class="btn btn-primary py-3 px-5 btn-pill">Admission Now</a></p> -->

                </div>

                <div class="col-lg-5 ml-auto" data-aos="fade-up" data-aos-delay="500"> <!--col-lg-5 ml-auto -->

                  <form class="form-box">



                    <h3 class="h4 text-black mb-4">From Preference Consent</h3>
                    <p>ข้าพเจ้าให้ความยินยอมในการเก็บ รวมรวม ใช้ หรือเปิดเผย ข้อมูล ส่วนบุคคลของข้าพเจ้าแก่ บริษัท ACME จํากัด ("บริษัทฯ") เพื่อวัตถุประสงค์ซึ่งเราได้ปฏิบัติตามฐาน การให้ ความ ยินยอมดังต่อไปนี้:</p>
                    <div id="purpose_option"></div>
                    <div class="form-group">
                      <input type="submit" class="btn btn-primary btn-pill" id="btn" style="margin-top: 20px;">
                    </div>
                  </form>

                  <!-- <iframe src="https://172.21.20.115/admin/PreferenceConsentFormView?key=HRFckZ09CBZFQHlpJa2upA%3d%3d&token_key=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZXJ2aWNlX2lkIjoiMTIiLCJkc19pZCI6IjUxIiwiZW1haWwiOiJraGF0YXd1dEBuZXRrYXN5c3RlbS5jb20ifQ.a6geMfxgV1oNpxTc9QUMNcLwAnLy4VqrQXtfGBnyBv4" width="550px" height="700px" styles="border:none; overflow-x: hidden; overflow-y: hidden; display: block;" >
                       </iframe>-->
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer-->
  <footer class="footer py-4">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-4 text-lg-start">Copyright &copy; Your Website 2023</div>
        <div class="col-lg-4 my-3 my-lg-0">
          <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
          <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        </div>
        <div class="col-lg-4 text-lg-end">
          <a class="link-dark text-decoration-none me-3" href="#!">Privacy Policy</a>
          <a class="link-dark text-decoration-none me-3" href="#!">Terms of Use</a>
          <a class="link-dark text-decoration-none "
            href="https://203.170.240.1:8807/subjectrightrequest/datasubjectrequestform?key=%2fX81Ke37EH458iCPuqIOAw%3d%3d">PDPA
            Right Request</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Core theme JS-->
  <script src="js/scripts.js"></script>
  <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>



  <script>

    var key = "msIXEsXJcpm9c%2f%2fQSYoScQ%3d%3d";
    var token_key = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkc19pZCI6Ijg2In0.syaRkqmtrAj-IGPfjvcbAffl0Y5JRM9Oqy-0yOg6idM"; //john

    var settings = {
        "url": "https://203.170.240.1:8807/api/AdminPreferenceConsentForm/PreferenceFormToken?key="+key+"&token_key="+token_key+"",
        "method": "GET",
        "timeout": 0,
    };
    console.log(settings);
    var purpose_option = document.getElementById('purpose_option')

    $.ajax(settings).done(function (response) {
        console.log(response);
        var option = response.purpose_option;
        console.log(option);

        for (var i = 0; i < option.length; i++) {
            var div = document.createElement("div");
            div.innerHTML = '<div class="form-check"><input class="form-check-input" value = "' + option[i].purpose_id + '" type="checkbox"><label class="form-check-label" for="flexRadioDefault1">  ' + option[i].purpose_th + '</label></div>';
            //'purpose_id: ' + purposeoption[i].purpose_id;
            //console.log(div.innerHTML);
            purpose_option.appendChild(div);

        }

        const form = document.querySelector('form');

        form.addEventListener('submit', (e) => {
            e.preventDefault();

            var ski = {};
            var data = "";
        
            document.querySelectorAll('[type="checkbox"]').forEach(item => {
                // if (item.checked === true) {
                //     ski[purposes] = item.value;
                // }

                //var data;
               
               if (item.checked==true) {
                  if (data !=""){
                    data +=",";
                  }
                    //data.push(item.value);
                    data += "{ PurposeOption:" + item.value +"}" ;
                }
            })
            //data +="}";
            console.log(data);


            //    for (var i = 0; i < ski.length; i++) {
            //         console.log(i + ski[i])

                var settings2 = {
                    "url": "https://203.170.240.1:8807/AdminPreferenceConsentForm/PreferenceFormConsent",
                    "method": "PUT",
                    "timeout": 0,
                    "headers": {
                        "Accept": "application/json, text/javascript, */*; q=0.01",
                        "Action": "Insert",
                        "AuthorizationToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjkwMjUzNjAzIiwiQ3VycmVudFVzZXIiOiJhZG1pbiJ9.OFsYAll97R4xZ-Jl0MQyH1AhSaj2Hx-1TFbIW5RPaec",
                        "Connection": "keep-alive",
                        "Content-Type": "application/json; charset=UTF-8",
                        "Origin": "https://203.170.240.1:8807/",
                        "Referer": "https://203.170.240.1:8807/admin/PreferenceConsentFormView?key=Mdd3cr0tCDfsUpfhJ9pRvA%3d%3d&token_key=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzZXJ2aWNlX2lkIjoiNTI1NiIsImRzX2lkIjoiMTMxNjI2IiwiZW1haWwiOiJhdmFAbWFpbC5jb20ifQ.YO7IbHufMZ2E7-wc70icb24szbLJKWbQyz8f4Kc5zic",
                        "RequestType": "JSON",
                        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
                        "X-Requested-With": "XMLHttpRequest"
                    },
                    "data": "{\r\n    \"purpose_option\": [" + data + "],\r\n    \"key\": \""+key+"\",\r\n    \"token_key\": \""+token_key+"\"\r\n}",
                };
            
                console.log(settings2);

                $.ajax(settings2).done(function (response2) {
                    console.log(response2);
                    if(response2.status = "Successfully updated"){
                            alert("Successfully updated");
                        }
                });
        })

    });






</script>

<script>
    		fetch("https://qatest_platinum.pdpanetka.com/api/cookie/cookiesetting?key=Cr14Y%2fDJkWjTrSLgA7fdmw%3d%3d")
    		.then((res) => res.text())
    		.then((html) => {
        	var documentFragment = document.createRange().createContextualFragment(html);
        	document.body.appendChild(documentFragment);
    		})
    		.catch((err) => console.warn('API went wrong.', err));
	</script>

	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-H55XGLPMFT"></script>
	<script>
  		window.dataLayer = window.dataLayer || [];
  		function gtag(){dataLayer.push(arguments);}
  		gtag('js', new Date());

  		gtag('config', 'G-H55XGLPMFT');
	</script>

</body>

</html>